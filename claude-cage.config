claude_cage {

    -- Project name (required - either in config or on command line)
    -- Can be specified here OR on command line: sudo claude-cage projectname
    -- Command line takes precedence over config file
    -- Sync mode: Sets defaults for userAppend and sync directory name
    -- Direct mount mode: Used as identifier and for per-project username
    project = "myproject",

    -- Project-specific config files (optional)
    -- Create projectname.claude-cage.config for project-specific overrides
    -- Example: backend.claude-cage.config, frontend.claude-cage.config
    -- Then run: sudo claude-cage backend

    -- Base user name (default: "claude")
    -- user = "claude",

    -- User isolation mode (default: "single")
    -- Options: "single" or "per-project"
    --
    -- Single-user mode (default): All projects share one user
    --   - Username: "claude" (just the base username)
    --   - User home: /home/claude/ (standard location)
    --   - Network rules: Shared across projects, persist until last instance exits
    --   - Claude Code authentication: Login once, works for all projects
    --
    -- Per-project mode: Each project gets its own user
    --   - Username: "claude-myproject" (user + "-" + userAppend or project)
    --   - User home: /home/.claude-cage/claude-myproject/
    --   - Network rules: Project-specific, cleaned up when project exits
    --   - Claude Code authentication: Requires login for each new project user
    --
    -- userMode = "single",

    -- Optional: Custom suffix for per-project mode (overrides using project name)
    -- Only applies when userMode = "per-project"
    -- userAppend = "myproject",

    -- ============================================================================
    -- MODE SELECTION: Choose sync mode (default) or direct mount mode
    -- ============================================================================

    -- Direct mount mode (default: false)
    -- false: Sync mode - creates sync directory with unison, provides file exclusion
    -- "workspace": Direct mount - mounts entire source, Claude can access sibling projects
    -- "project": Direct mount - mounts only the specified project, no sibling access
    --
    -- In both direct mount modes:
    --   - Command-line argument specifies which project to work in (required)
    --   - No file exclusion - all files in mounted directory are accessible
    --   - Only use with directories containing files safe for Claude to access
    --
    -- Workspace mode: Mount point name derived from source directory basename
    --   Example: cd ~/Projects/public && sudo claude-cage my-project
    --   Mounts ~/Projects/public/ to /home/claude/caged/public/
    --   Claude starts in /home/claude/caged/public/my-project/ but can cd to siblings
    --
    -- Project mode: Mount point name is the project subdirectory name
    --   Example: cd ~/Projects/public && sudo claude-cage my-project
    --   Mounts ~/Projects/public/my-project/ to /home/claude/caged/my-project/
    --   Claude starts at mount root, cannot access sibling projects
    --
    -- directMount = false,

    -- ============================================================================
    -- SYNC MODE SETTINGS (ignored in direct mount mode)
    -- ============================================================================

    -- Source directory under current directory to allow reading from
    -- Sync mode: If not provided, defaults to project name
    -- Direct mount modes: Defaults to "." (current directory) if not set
    --   In workspace mode: entire source directory is mounted
    --   In project mode: source/project-subdirectory is mounted
    -- source = "my-directory",

    -- Sync directory for unison to sync source with (sync mode only)
    -- Default: .caged/project-name/sync
    -- Structure: .caged/project-name/sync and .caged/project-name/excludes-cache
    -- Add ".caged" to .gitignore if running from within a git repository
    -- sync = ".caged/myproject/sync",

    -- Mount configuration
    -- mountBase: Base directory under user home (default: "caged")
    --   Set to "" to mount directly under user home
    --   Example: mountBase = "caged" → /home/claude/caged/<project>/
    --   Example: mountBase = "" → /home/claude/<project>/
    -- mountBase = "caged",

    -- mounted: Final directory name (default: project name)
    --   This is the actual working directory where Claude starts
    --   Example: mounted = "my-app" → /home/claude/caged/my-app/
    -- mounted = "",  -- Defaults to project name

    -- Show ASCII art banner (default: true)
    -- Set to false to disable banner, or use --no-banner CLI flag
    -- showBanner = false,

    -- ============================================================================
    -- FILE EXCLUSION (SYNC MODE ONLY - ignored in direct mount mode)
    -- ============================================================================

    -- PROJECT-SPECIFIC excludes (add to user/system defaults)
    -- These are merged with excludes from system and user configs
    -- Common defaults are already set in example-user-config

    -- excludePath: exact paths relative to source root
    -- excludePath = { "config/production.yml", "deploy/secrets.txt" },

    -- excludeName: files/folders by name anywhere in the tree
    -- Defaults from example-user-config include: .env, secrets.json, *.key, *.pem,
    -- node_modules, target, .venv, vendor, __pycache__, build, dist
    --
    -- Add project-specific excludes:
    -- excludeName = { "application-*.properties" },  -- Spring Boot configs

    -- excludeRegex: regex patterns for complex matching
    -- excludeRegex = { ".*\\.log$" },

    -- belowPath: paths at the root and everything below them
    -- Default from example-user-config: .git
    --
    -- Note: belowPath only matches at the specified path from root, not everywhere
    -- Use excludeName for directories that can appear anywhere (like node_modules)
    -- belowPath = {},

    -- ============================================================================
    -- NETWORK RESTRICTIONS (optional - defense in depth)
    -- ============================================================================

    -- Network mode (default: "disabled")
    -- Options: "disabled", "allowlist", "blocklist"
    -- networkMode = "disabled",

    -- NOTE: In single-user mode (default), network rules are shared across all
    -- projects and persist until the last instance exits. In per-project mode,
    -- each project gets its own network rules.

    -- Allowlist mode: Only allow specific connections (everything else blocked)
    -- allowedDomains = { "github.com:443", "registry.npmjs.org:443" },
    -- allowedIPs = { "127.0.0.1:5432" },
    -- allowedNetworks = { "192.168.1.0/24" },

    -- Blocklist mode: Block specific connections (everything else allowed)
    -- blockNetworks = { "127.0.0.1", "192.168.0.0/16", "10.0.0.0/8" },
    -- blockDomains = { "internal.company.com" },
    -- blockIPs = { "169.254.169.254" },

    -- Blocklist exceptions: Allow specific connections even when blocked
    -- (Can use allowedDomains/IPs/Networks in blocklist mode for exceptions)
    -- allowedIPs = { "127.0.0.1:5432" },  -- Allow PostgreSQL even if localhost blocked
}
